angular.module("myPortfolioApp",[]).controller("PortfolioController",["$scope","$http",function(s,o){"use strict";function e(){localStorage.stocks=JSON.stringify(s.stocks)}function t(){for(var e="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quote%20where%20symbol%20in%20(",t=")&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=",r=s.stocks.length,c="",a=0;r>a;a++)c+='"',c+=s.stocks[a].symbol,c+='"',a+1!==r&&(c+=",");var l=e+encodeURI(c)+t;r>0?o({url:l}).success(function(o){var e=o.query.results.quote;e instanceof Array||(e=new Array(e));for(var t=e.length,r=0,c=0;t>c;c++){s.stocks[c].symbol=e[c].Symbol,s.stocks[c].change=e[c].Change,s.stocks[c].name=e[c].Name,s.stocks[c].price=e[c].LastTradePriceOnly;var a=s.stocks[c].price*s.stocks[c].shares/100;s.stocks[c].value=a,r+=a}s.curr=r}):s.curr=""}if(s.stocks=[{symbol:"YHOO",shares:50}],localStorage.stocks){s.stocks=[];for(var r=JSON.parse(localStorage.stocks),c=r.length,a=0;c>a;a++)s.stocks.push({symbol:r[a].symbol,shares:r[a].shares})}s.changeClass=function(s){return 0>s?"label-danger":"label-success"},s.deleteStock=function(o){for(var r=s.stocks.length,c=-1,a=0;r>a;a++)s.stocks[a].$$hashKey===o.$$hashKey&&(c=a);s.stocks.splice(c,1),e(),t()},s.addSymbol=function(){s.stocks.push({symbol:s.symbolText,shares:s.numberOfSharesText}),s.symbolText="",s.numberOfSharesText="",e(),t()},t()}]);