!function(){"use strict";angular.module("myPortfolioApp",["ngRoute","ngTouch","googlechart"]).config(function($routeProvider){$routeProvider.when("/",{controller:"OverviewController",templateUrl:"overview.html"}).when("/detail/:symbolId",{controller:"DetailController",templateUrl:"detail.html"}).otherwise({redirectTo:"/"})})}(),function(){"use strict";angular.module("myPortfolioApp").controller("OverviewController",function($scope,$http){function getStocks(){return localStorage.symbolList?JSON.parse(localStorage.symbolList):defaultSymbolList}function setStocks(stocks){localStorage.symbolList=JSON.stringify(stocks)}function fetchData(){var quoteUrlPrefix="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20csv%20where%20url%3D%22http%3A%2F%2Fdownload.finance.yahoo.com%2Fd%2Fquotes.csv%3Fs%3D",quoteUrlSuffix="%26f%3Dsnl1c1%26e%3D.csv%22%20and%20columns%3D%22symbol%2Cname%2Cprice%2Cchange%22&format=json&diagnostics=true&callback=",symbolString=Object.keys($scope.stocks).join(","),quoteUrl=quoteUrlPrefix+encodeURI(symbolString)+quoteUrlSuffix;""===symbolString?$scope.quotes={}:$http({url:quoteUrl}).success(function(quotes){$scope.quotes=quotes.query.results.row instanceof Array?quotes.query.results.row:new Array(quotes.query.results.row)})}var defaultSymbolList={YHOO:{shares:100},GOOG:{shares:50},MSFT:{shares:150}};$scope.stocks=getStocks(),$scope.quotes=[],$scope.changeClass=function(change){return 0>change?"label-danger":"label-success"},$scope.numberOfShares=function(symbol){return $scope.stocks[symbol]?$scope.stocks[symbol].shares:void 0},$scope.marketValue=function(symbol,price){return $scope.stocks[symbol]?$scope.stocks[symbol].shares*(price/100):void 0},$scope.totalPortfolioValue=function(){for(var totalPortfolioValue=0,count=$scope.quotes.length,i=0;count>i;i++)$scope.stocks[$scope.quotes[i].symbol]&&(totalPortfolioValue+=$scope.stocks[$scope.quotes[i].symbol].shares*($scope.quotes[i].price/100));return totalPortfolioValue},$scope.deleteStock=function(quote){delete $scope.stocks[quote.symbol],fetchData(),setStocks($scope.stocks)},$scope.editStock=function(quote){$scope.symbolInput=quote.symbol,$scope.numberOfSharesInput=$scope.stocks[quote.symbol].shares,$('input[ng-model="numberOfSharesInput"]').focus()},$scope.addSymbol=function(){$scope.stocks[$scope.symbolInput.toUpperCase()]={shares:$scope.numberOfSharesInput},$scope.symbolInput="",$scope.numberOfSharesInput="",$('input[ng-model="symbolInput"]').focus(),fetchData(),setStocks($scope.stocks)},fetchData()})}(),function(){"use strict";angular.module("myPortfolioApp").controller("DetailController",function($scope,$http,$routeParams){function parseChartData(chartData){chartData.reverse(),chartData.pop(),$scope.chartObject={};for(var rows=[],i=0;i<chartData.length;i++){var item=[],dateObj={v:new Date(chartData[i].date)},priceObj={v:chartData[i].close};item.push(dateObj),item.push(priceObj),rows.push({c:item})}$scope.chartObject.type="LineChart",$scope.chartObject.options={hAxis:{showTextEvery:1},legend:"none",height:300,title:$scope.quote.symbol},$scope.chartObject.data={cols:[{id:"t",label:"Date",type:"date"},{id:"s",label:"Price",type:"number"}],rows:rows}}$scope.quote=[];var today=new Date,yearEnd=today.getFullYear(),yearStart=yearEnd-1,day=today.getDate(),month=today.getMonth(),frequency="w",chartUrl="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20csv%20where%20url%3D%22http%3A%2F%2Fichart.finance.yahoo.com%2Ftable.csv%3Fa%3D"+month+"%26b%3D"+day+"%26c%3D"+yearStart+"%26d%3D"+month+"%26e%3D"+day+"%26f%3D"+yearEnd+"%26g%3D"+frequency+"%26s%3D"+$routeParams.symbolId+"%22%20and%20columns%3D%22date%2Copen%2Chigh%2Clow%2Cclose%2Cvolume%2Cadj_close%22&format=json&diagnostics=true&callback=",quoteUrl="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20csv%20where%20url%3D%22http%3A%2F%2Fdownload.finance.yahoo.com%2Fd%2Fquotes.csv%3Fs%3D"+$routeParams.symbolId+"%26f%3Dsnxc4l1pc1p2kj%26e%3D.csv%22%20and%20columns%3D%22symbol%2Cname%2Cexchange%2Ccurrency%2Cprice%2CpreviousClose%2Cchange%2CpercentChange%2CyearHigh%2CyearLow%22&format=json&diagnostics=true&callback=";$scope.changeClass=function(change){return 0>change?"label-danger":"label-success"},$http({url:quoteUrl}).success(function(quotes){$scope.quote=quotes.query.results.row}),$http({url:chartUrl}).success(function(quotes){var chartData=quotes.query.results.row;parseChartData(chartData)})})}();